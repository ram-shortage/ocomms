# Milestone v0.1.0: Full Conversation

**Status:** SHIPPED 2026-01-18
**Phases:** 1-8
**Total Plans:** 23

## Overview

OComms delivers a complete self-hosted team communication platform through 8 sequential phases. Starting with authentication and workspace foundations, we build up through real-time messaging, threading, notifications, and search — culminating in production-ready Docker deployment. Each phase delivers working functionality that builds on the previous, with the goal of a Slack-like experience under full organizational control.

## Phases

### Phase 1: Foundation
**Goal**: Database schema, authentication, workspace/member primitives with profiles
**Depends on**: Nothing (first phase)
**Requirements**: AUTH-01, AUTH-02, AUTH-03, AUTH-04, WKSP-01, WKSP-02, WKSP-03, MEMB-01, MEMB-02, MEMB-03, MEMB-04, MEMB-05, MEMB-06
**Plans**: 4 plans

Plans:
- [x] 01-01: Project scaffolding and database setup
- [x] 01-02: Authentication system
- [x] 01-03: Workspace and member management
- [x] 01-04: Member profiles and avatars

**Details:**
- Next.js 15 with Tailwind CSS v4, shadcn/ui, Drizzle ORM
- better-auth with email/password, email verification, organization plugin
- Workspace creation with auto-slug, member invitation, role management
- Profile system with display names, avatars, bios

### Phase 2: Channels & DMs
**Goal**: Channel and DM primitives — conversation containers without messages yet
**Depends on**: Phase 1
**Requirements**: CHAN-01, CHAN-02, CHAN-03, CHAN-04, CHAN-05, CHAN-06, CHAN-07, DM-01, DM-02, DM-03
**Plans**: 3 plans

Plans:
- [x] 02-01: Channel CRUD and membership
- [x] 02-02: Channel management
- [x] 02-03: Direct messages

**Details:**
- Public/private channels with membership tracking
- Channel topic/description editing
- Leave channel with admin protection
- 1:1 and group DMs with participant management

### Phase 3: Real-Time Messaging
**Goal**: Messages delivered instantly via WebSockets with basic presence
**Depends on**: Phase 2
**Requirements**: MSG-01, MSG-02, MSG-03, MSG-04, PRES-01, PRES-02
**Plans**: 3 plans

Plans:
- [x] 03-01: WebSocket gateway and Redis pub/sub
- [x] 03-02: Message persistence and delivery
- [x] 03-03: Presence system

**Details:**
- Custom Socket.IO server with Redis adapter
- Cookie-based WebSocket authentication
- Room-based message routing (channel:, dm:, workspace:, user:)
- Soft delete for messages
- 60s TTL presence with heartbeat

### Phase 4: Threading & Reactions
**Goal**: Threaded conversations, emoji reactions, and pinned messages
**Depends on**: Phase 3
**Requirements**: THRD-01, THRD-02, THRD-03, THRD-04, REAC-01, REAC-02, REAC-03, CHAN-08, CHAN-09
**Plans**: 3 plans

Plans:
- [x] 04-01: Threading model and UI
- [x] 04-02: Emoji reactions
- [x] 04-03: Pinned messages

**Details:**
- Single-level threading with self-referencing parentId
- All Threads page with thread participation tracking
- frimousse emoji picker (<5KB)
- Toggle-based reactions with composite unique constraint
- REST API for pin operations

### Phase 5: Mentions & Notifications
**Goal**: @mentions with notification delivery and channel settings
**Depends on**: Phase 4
**Requirements**: NOTF-01, NOTF-02, NOTF-03, NOTF-04, NOTF-05, NOTF-06
**Plans**: 3 plans

Plans:
- [x] 05-01: Mention parsing and highlighting
- [x] 05-02: Notification delivery
- [x] 05-03: Channel notification settings

**Details:**
- @user, @channel, @here mention support
- Autocomplete with keyboard navigation
- Real-time notification delivery to user rooms
- Mute and mention-only channel modes

### Phase 6: Attention Management
**Goal**: Unread counts and read state management
**Depends on**: Phase 5
**Requirements**: UNRD-01, UNRD-02, UNRD-03
**Plans**: 2 plans

Plans:
- [x] 06-01: Read state tracking and unread counts
- [x] 06-02: Sidebar unread UI and mark-as-read actions

**Details:**
- Sequence-based read state tracking
- Redis-cached unread counts (60s TTL)
- Auto mark-as-read on navigation
- Mark message as unread for later

### Phase 7: Search
**Goal**: Full-text message search
**Depends on**: Phase 6
**Requirements**: SRCH-01, SRCH-02
**Plans**: 2 plans

Plans:
- [x] 07-01: Search indexing and query
- [x] 07-02: Search UI and navigation

**Details:**
- PostgreSQL native full-text search (tsvector + GIN index)
- Permission-filtered results
- URL-based search state for shareable links

### Phase 8: Self-Hosted Packaging
**Goal**: Production-ready Docker deployment with data management
**Depends on**: Phase 7
**Requirements**: INFR-01, INFR-02, INFR-03, INFR-04, INFR-05
**Plans**: 3 plans

Plans:
- [x] 08-01: Docker Compose configuration
- [x] 08-02: Backup and restore tooling
- [x] 08-03: Data export

**Details:**
- Multi-stage Dockerfile with esbuild bundling
- Docker Compose with nginx, app, db, redis
- Health checks for service dependencies
- pg_dump backup/restore scripts
- JSON data export for GDPR compliance

---

## Milestone Summary

**Key Decisions:**

| Phase | Decision | Rationale |
|-------|----------|-----------|
| 1-01 | Manual better-auth schema | CLI requires database connection |
| 1-02 | Fire-and-forget emails | Prevent timing attacks revealing user existence |
| 3-01 | Redis graceful fallback | Local dev works without Redis |
| 3-01 | Cookie-based WebSocket auth | Consistent with HTTP routes |
| 4-01 | Self-referencing parentId | No separate threads table needed |
| 4-02 | frimousse emoji picker | <5KB vs 50KB alternatives |
| 7-01 | PostgreSQL native FTS | Data sovereignty over Meilisearch |
| 8-01 | esbuild for server bundling | Fastest bundler, handles node externals |

**Issues Resolved:**

- Context overflow concerns resolved with efficient component patterns
- Socket.IO scaling with Redis adapter
- Permission filtering at query time for search

**Technical Debt Incurred:**

- Missing sidebar navigation links for /threads and /search pages (documented in audit)

---

_For current project status, see .planning/ROADMAP.md_
