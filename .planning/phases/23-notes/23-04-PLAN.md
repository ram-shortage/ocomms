---
phase: 23-notes
plan: 04
type: execute
wave: 3
depends_on: ["23-02"]
files_modified:
  - src/components/workspace/workspace-sidebar.tsx
  - src/app/(workspace)/[workspaceSlug]/notes/page.tsx
  - src/app/(workspace)/[workspaceSlug]/notes/layout.tsx
autonomous: true

must_haves:
  truths:
    - "User can click 'My Notes' link in sidebar to access personal scratchpad"
    - "Personal notes page shows full-height markdown editor"
    - "Personal notes are private to the user (not shared)"
    - "Personal notes are workspace-scoped (one per user per workspace)"
  artifacts:
    - path: "src/components/workspace/workspace-sidebar.tsx"
      provides: "My Notes link in sidebar quick links section"
      contains: "StickyNote"
    - path: "src/app/(workspace)/[workspaceSlug]/notes/page.tsx"
      provides: "Personal notes page with NoteEditor"
      exports: ["default"]
  key_links:
    - from: "src/components/workspace/workspace-sidebar.tsx"
      to: "/[workspaceSlug]/notes"
      via: "Link href"
      pattern: "href=.*notes"
    - from: "src/app/(workspace)/[workspaceSlug]/notes/page.tsx"
      to: "src/components/notes/note-editor.tsx"
      via: "component import"
      pattern: "NoteEditor"
---

<objective>
Add personal notes scratchpad accessible from workspace sidebar, giving each user a private workspace-scoped notes area.

Purpose: Deliver NOTE-02 - each user has a personal notes scratchpad per workspace.
Output: Sidebar link to personal notes, notes page with full-height editor.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/23-notes/23-RESEARCH.md

@src/components/workspace/workspace-sidebar.tsx (integration target)
@src/components/notes/note-editor.tsx (from 23-02)
@src/app/(workspace)/[workspaceSlug]/profile/page.tsx (page pattern)
@src/app/(workspace)/[workspaceSlug]/threads/page.tsx (existing quick link page)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add personal notes link to sidebar</name>
  <files>src/components/workspace/workspace-sidebar.tsx</files>
  <action>
Update `src/components/workspace/workspace-sidebar.tsx`:

1. Import StickyNote (or FileText, BookOpen) from lucide-react
   - StickyNote is most appropriate for personal notes scratchpad

2. Add "My Notes" link in the Quick links section, after Threads and Search:
```tsx
<Link
  href={`/${workspace.slug}/notes`}
  className={cn(
    "flex items-center gap-2 px-2 py-1.5 rounded-md text-sm hover:bg-accent transition-colors",
    pathname === `/${workspace.slug}/notes` && "bg-accent"
  )}
>
  <StickyNote className="h-4 w-4" />
  My Notes
</Link>
```

Place it after Search, before the Channels section.
  </action>
  <verify>Sidebar shows "My Notes" link with icon</verify>
  <done>Personal notes link visible in sidebar quick links section</done>
</task>

<task type="auto">
  <name>Task 2: Create personal notes page</name>
  <files>src/app/(workspace)/[workspaceSlug]/notes/page.tsx</files>
  <action>
**Create `src/app/(workspace)/[workspaceSlug]/notes/page.tsx`:**

This is a server component page that renders the personal notes editor.

1. Import auth from better-auth (same pattern as profile page)
2. Import headers from "next/headers"
3. Import redirect from "next/navigation"
4. Import NoteEditor from "@/components/notes/note-editor"
5. Import db and organizations query (to get workspace id from slug)

Page structure:
```tsx
import { auth } from "@/lib/auth";
import { headers } from "next/headers";
import { redirect } from "next/navigation";
import { db } from "@/db";
import { organizations } from "@/db/schema";
import { eq } from "drizzle-orm";
import { NoteEditor } from "@/components/notes/note-editor";

interface PageProps {
  params: Promise<{ workspaceSlug: string }>;
}

export default async function PersonalNotesPage({ params }: PageProps) {
  const { workspaceSlug } = await params;
  const session = await auth.api.getSession({ headers: await headers() });

  if (!session) {
    redirect("/login");
  }

  // Get workspace (organization) by slug
  const workspace = await db.query.organizations.findFirst({
    where: eq(organizations.slug, workspaceSlug),
  });

  if (!workspace) {
    redirect("/");
  }

  return (
    <div className="flex flex-col h-full">
      <header className="border-b px-6 py-4">
        <h1 className="text-xl font-semibold">My Notes</h1>
        <p className="text-sm text-muted-foreground">
          Your personal scratchpad for {workspace.name}
        </p>
      </header>
      <div className="flex-1 p-6 overflow-hidden">
        <div className="h-full bg-card rounded-lg border">
          <NoteEditor
            noteType="personal"
            workspaceId={workspace.id}
          />
        </div>
      </div>
    </div>
  );
}
```

Theme-aware styling:
- bg-card for the editor container
- text-muted-foreground for subtitle
- Standard border and rounded-lg
  </action>
  <verify>Page renders at /[workspaceSlug]/notes with NoteEditor</verify>
  <done>Personal notes page renders full-height markdown editor</done>
</task>

<task type="auto">
  <name>Task 3: Test end-to-end personal notes flow</name>
  <files>none (testing)</files>
  <action>
Manual verification steps:

1. Navigate to workspace sidebar
2. Click "My Notes" link
3. Verify page loads with "My Notes" header
4. Click "Edit" button to enter edit mode
5. Type some markdown content (e.g., "# My Tasks\n- [ ] Item 1\n- [ ] Item 2")
6. Wait for auto-save (2 seconds)
7. Click "Preview" to see rendered markdown
8. Verify task list renders with checkboxes
9. Refresh page - content should persist
10. Switch to different workspace - notes should be workspace-specific (empty or different)

If any step fails, investigate and fix before marking complete.
  </action>
  <verify>All manual test steps pass, notes persist and render correctly</verify>
  <done>Personal notes flow works end-to-end: sidebar link -> page -> edit -> save -> preview -> persist</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes
2. Sidebar shows "My Notes" link with StickyNote icon
3. Clicking link navigates to /[workspaceSlug]/notes
4. Page shows full-height NoteEditor
5. Notes can be edited, auto-save works, content persists
6. Notes are workspace-scoped (different per workspace)
</verification>

<success_criteria>
- NOTE-02: Each user has a personal notes scratchpad (per workspace)
- NOTE-03: User can edit notes using markdown syntax
- NOTE-04: User can preview rendered markdown while editing
- Personal notes are private (only visible to owner)
</success_criteria>

<output>
After completion, create `.planning/phases/23-notes/23-04-SUMMARY.md`
</output>
