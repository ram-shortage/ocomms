---
phase: 25-job-queue-foundation
plan: 05
type: execute
wave: 3
depends_on: ["25-03", "25-04"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Scheduled messages deliver at the correct time"
    - "Reminders fire and can be snoozed/completed"
    - "Features survive server restart (persistence verified)"
    - "All requirements SCHD-01 through RMND-07 pass verification"
  artifacts: []
  key_links: []
---

<objective>
Verify complete job queue foundation implementation with end-to-end testing of scheduled messages and reminders.

Purpose: Ensure all requirements are met and the system behaves correctly in real-world scenarios, especially persistence across restarts.

Output: Verified working implementation ready for production.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/25-job-queue-foundation/25-03-SUMMARY.md
@.planning/phases/25-job-queue-foundation/25-04-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Verify scheduled messages and reminders</name>
  <what-built>
    Complete job queue foundation with:
    - BullMQ infrastructure (worker process, queues)
    - Scheduled messages (schedule, view, edit, cancel, send now)
    - Reminders (set, view, snooze, complete, recurring)
    - Persistence across restarts
    - Socket.IO real-time updates from worker
    - Push notifications for reminders
  </what-built>
  <how-to-verify>
    Start both server and worker in separate terminals:
    - Terminal 1: `npm run dev`
    - Terminal 2: `npm run worker`

    **Scheduled Messages:**
    1. Go to any channel
    2. Type a message
    3. Click dropdown arrow next to Send button
    4. Select "Tomorrow at 9:00 AM" - verify message is scheduled
    5. Click "Scheduled" in sidebar - verify message appears in list
    6. Click Edit on scheduled message - change content - Save
    7. Click Cancel on a different scheduled message - verify removed from list
    8. Create another scheduled message for 1 minute from now
    9. Wait - verify message appears in channel at scheduled time
    10. Repeat step 8-9 in a DM to verify DM support

    **Reminders:**
    1. Find any message in a channel
    2. Click â‹® menu on message, select "Remind me..."
    3. Select "Tomorrow at 9:00 AM" - verify toast shows success
    4. Click "Reminders" in sidebar - verify reminder in list
    5. Create another reminder for 1 minute from now
    6. Wait - verify:
       - Toast appears with reminder
       - Push notification received (if enabled)
    7. Click snooze - select "20 minutes" - verify reminder moved
    8. Create new reminder, mark as complete - verify removed from active list
    9. Create recurring reminder (daily) - verify fires, then shows next occurrence

    **Persistence Test:**
    1. Schedule a message for 2 minutes from now
    2. Set a reminder for 2 minutes from now
    3. Stop the worker (Ctrl+C)
    4. Restart the worker: `npm run worker`
    5. Wait for scheduled time - both should still fire correctly

    **Requirements Checklist:**
    - [ ] SCHD-01: Schedule message for specific date/time
    - [ ] SCHD-02: View list of scheduled messages
    - [ ] SCHD-03: Edit scheduled message before send time
    - [ ] SCHD-04: Cancel scheduled message
    - [ ] SCHD-05: Works in channels and DMs
    - [ ] SCHD-06: Timezone-aware display
    - [ ] SCHD-07: Quick-pick presets available
    - [ ] RMND-01: Set reminder on any message
    - [ ] RMND-02: Set reminder for specific date/time
    - [ ] RMND-03: View list of pending reminders
    - [ ] RMND-04: Mark reminder as complete
    - [ ] RMND-05: Snooze reminder when fired
    - [ ] RMND-06: Reminder links to original message
    - [ ] RMND-07: Recurring reminders (daily, weekly)
  </how-to-verify>
  <resume-signal>
    Type "verified" if all checks pass.
    If issues found, describe them and we'll create fix tasks.
  </resume-signal>
</task>

</tasks>

<verification>
User verification of complete feature set.
</verification>

<success_criteria>
- All 14 requirements (SCHD-01 through SCHD-07, RMND-01 through RMND-07) verified working
- Persistence across server restart confirmed
- Real-time updates working (Socket.IO from worker)
- Push notifications delivered for reminders
- UI consistent with 25-CONTEXT.md decisions
</success_criteria>

<output>
After completion, create `.planning/phases/25-job-queue-foundation/25-05-SUMMARY.md`
</output>
