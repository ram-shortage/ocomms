---
phase: 35-mobile-redesign
plan: 06
type: execute
wave: 3
depends_on: ["35-03", "35-04", "35-05"]
files_modified:
  - src/app/globals.css
  - src/components/ui/dropdown-menu.tsx
  - src/components/ui/button.tsx
  - src/components/message/message-item.tsx
autonomous: false

must_haves:
  truths:
    - "All interactive elements have 44px minimum touch target on mobile"
    - "Dropdown menu items have consistent mobile sizing"
    - "Mobile spacing is consistent across views"
    - "No elements are unreachable due to small touch targets"
  artifacts:
    - path: "src/app/globals.css"
      provides: "Touch target utility classes"
      contains: "touch-target"
  key_links:
    - from: "src/components/ui/dropdown-menu.tsx"
      to: "min-h-11"
      via: "mobile variant"
      pattern: "min-h-11"
---

<objective>
Audit and enforce 44px minimum touch targets across all mobile interactive elements and ensure consistent spacing.

Purpose: Touch target size is critical for mobile usability. This final polish pass ensures all buttons, links, and menu items meet the 44px minimum and spacing is consistent across views.

Output: Consistent touch-friendly UI across all mobile views.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/35-mobile-redesign/35-CONTEXT.md
@src/app/globals.css
@src/components/ui/dropdown-menu.tsx
@src/components/ui/button.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add touch target utility classes</name>
  <files>
    src/app/globals.css
  </files>
  <action>
Add utility classes to globals.css for consistent touch target enforcement:

```css
@layer utilities {
  /* Touch target enforcement - 44px minimum per iOS HIG / WCAG AAA */
  .touch-target {
    @apply min-h-11 min-w-11;
  }

  /* Safe area padding shortcuts */
  .pb-safe {
    padding-bottom: max(1rem, env(safe-area-inset-bottom));
  }

  .pt-safe {
    padding-top: max(1rem, env(safe-area-inset-top));
  }

  .px-safe {
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }
}
```

Check if these utilities already exist (from Phase 19). If they exist, ensure they're correct. If not, add them.

The `min-h-11` class in Tailwind 4 equals 44px (11 * 4px = 44px).
  </action>
  <verify>
1. Utility classes defined in globals.css
2. Classes can be applied to elements
3. Elements with .touch-target have 44px minimum dimensions
  </verify>
  <done>
Touch target utility classes available for use across components.
  </done>
</task>

<task type="auto">
  <name>Task 2: Audit and fix DropdownMenu touch targets</name>
  <files>
    src/components/ui/dropdown-menu.tsx
  </files>
  <action>
Update the DropdownMenu component to have proper touch targets on mobile:

1. Find DropdownMenuItem in the file
2. Add responsive sizing - larger on mobile, normal on desktop:
```tsx
const DropdownMenuItem = React.forwardRef<...>(
  ({ className, ...props }, ref) => (
    <DropdownMenuPrimitive.Item
      ref={ref}
      className={cn(
        // Existing classes
        "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors",
        // Mobile touch target - 44px minimum height
        "min-h-11 md:min-h-8",
        // ...rest of classes
        className
      )}
      {...props}
    />
  )
);
```

3. Apply same pattern to:
   - DropdownMenuCheckboxItem
   - DropdownMenuRadioItem
   - DropdownMenuSubTrigger

The pattern is: `min-h-11 md:min-h-8` - 44px on mobile, 32px on desktop.
  </action>
  <verify>
1. DropdownMenuItem has min-h-11 on mobile
2. Menu items are easily tappable on mobile viewport
3. Desktop sizing preserved (md:min-h-8)
  </verify>
  <done>
DropdownMenu items have 44px touch targets on mobile.
  </done>
</task>

<task type="auto">
  <name>Task 3: Audit key interactive components</name>
  <files>
    src/components/message/message-item.tsx
    src/components/message/message-actions.tsx
    src/components/channel/channel-list-client.tsx
    src/components/dm/dm-list-client.tsx
  </files>
  <action>
Audit and fix touch targets in key interactive components:

1. **Message actions** (reply, react, bookmark, etc.):
   - These should be at least 44px tap targets
   - On mobile, the action buttons may be shown on long-press (from MobileEmojiPicker context menu)
   - If inline actions exist, ensure they have min-h-11

2. **Channel list items**:
   - Each channel link should be easily tappable
   - Add min-h-11 to channel list item wrappers

3. **DM list items**:
   - Each conversation link should be 44px minimum height
   - Add min-h-11 to DM list item wrappers

4. **Any icon-only buttons**:
   - Icon buttons should have min-w-11 min-h-11 with adequate padding
   - The icon itself can be smaller (h-4 w-4) but the tappable area must be 44px

Pattern for icon buttons:
```tsx
<Button variant="ghost" size="icon" className="min-h-11 min-w-11">
  <Icon className="h-4 w-4" />
</Button>
```

Pattern for list items:
```tsx
<Link href={...} className="flex items-center gap-2 px-3 py-2 min-h-11 rounded-md hover:bg-accent">
  {/* content */}
</Link>
```

Scan these files and apply fixes where needed.
  </action>
  <verify>
1. Channel list items are 44px minimum height
2. DM list items are 44px minimum height
3. Message action buttons (if inline) are 44px
4. Icon buttons have proper touch targets
  </verify>
  <done>
Key interactive components have proper touch targets for mobile.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete mobile redesign:
- More menu with Scheduled/Reminders/Saved access
- Status setting on mobile
- Touch-optimized emoji picker
- Channel header overflow menu with all actions
- Analytics mobile responsive
- 44px touch targets across UI
  </what-built>
  <how-to-verify>
Test on mobile device or Chrome DevTools mobile viewport (375px):

1. **Navigation (MOBI2-01, 02, 03, 12)**:
   - Tap More button in bottom nav
   - Verify Scheduled, Reminders, Saved links present
   - Navigate to each, verify route highlighting works
   - Check Profile and Settings also accessible

2. **Status (MOBI2-04)**:
   - Access status from More menu
   - Set a status with emoji and text
   - Clear status
   - Verify status displays correctly

3. **Emoji Picker (MOBI2-05)**:
   - Open message composer
   - Tap emoji button
   - Verify picker opens as bottom sheet
   - Verify 6-column grid
   - Select emoji, verify it inserts

4. **Analytics (MOBI2-08)**:
   - Navigate to Settings > Analytics (admin required)
   - Verify all tabs accessible
   - Verify charts display
   - Verify date picker works

5. **Touch Targets (MOBI2-09)**:
   - Tap through various UI elements
   - Verify no targets are frustratingly small
   - Check dropdown menus, buttons, list items

6. **Channel Header (MOBI2-10)**:
   - Open a channel
   - Tap overflow menu (three dots)
   - Verify: Notifications, Notes, Pinned, Members, Leave visible
   - Test each action opens correctly

7. **Spacing (MOBI2-11)**:
   - General visual inspection
   - Consistent padding across views
   - No cramped or overly spaced areas
  </how-to-verify>
  <resume-signal>Type "approved" to complete phase, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
1. Touch target utility classes available
2. DropdownMenu items sized for mobile
3. Key interactive components have proper touch targets
4. Human verification confirms all mobile requirements met
</verification>

<success_criteria>
- MOBI2-09: All touch targets minimum 44px
- MOBI2-11: Consistent spacing and layout across all mobile views
- All prior MOBI2 requirements verified working
- No regression on desktop
</success_criteria>

<output>
After completion, create `.planning/phases/35-mobile-redesign/35-06-SUMMARY.md`
</output>
